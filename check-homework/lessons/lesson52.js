const a8_0x10fc95=a8_0xcd07;(function(_0x39b0a9,_0x8a0c5b){const _0x2f71eb=a8_0xcd07,_0x22b775=_0x39b0a9();while(!![]){try{const _0x313264=parseInt(_0x2f71eb(0x1b7))/0x1+parseInt(_0x2f71eb(0x19c))/0x2+-parseInt(_0x2f71eb(0x1ac))/0x3+parseInt(_0x2f71eb(0x18f))/0x4*(-parseInt(_0x2f71eb(0x1bd))/0x5)+-parseInt(_0x2f71eb(0x196))/0x6*(-parseInt(_0x2f71eb(0x1a7))/0x7)+-parseInt(_0x2f71eb(0x1b2))/0x8*(parseInt(_0x2f71eb(0x190))/0x9)+parseInt(_0x2f71eb(0x198))/0xa;if(_0x313264===_0x8a0c5b)break;else _0x22b775['push'](_0x22b775['shift']());}catch(_0x56058a){_0x22b775['push'](_0x22b775['shift']());}}}(a8_0x15f9,0x4290c));const {expect}=require(a8_0x10fc95(0x19d)),uuid=require(a8_0x10fc95(0x1a2))['v4'],{assertAuthenticated}=require(a8_0x10fc95(0x1a4)),{AuthenticationError}=require(a8_0x10fc95(0x194)),request=require('supertest'),sinon=require(a8_0x10fc95(0x19e)),fs=require('fs')[a8_0x10fc95(0x197)],path=require('path'),app=require(a8_0x10fc95(0x19b)),auth=require(a8_0x10fc95(0x1a4));function a8_0x15f9(){const _0x23c367=['4878070uNGDpQ','Выбрасывает\x20AuthenticationError,\x20если\x20пользователь\x20не\x20выполнил\x20аутентификацию','callsFake','../../src/server','496818xJOQea','chai','sinon','equal','stub','toString','uuid','Не\x20выбрасывает\x20исключение,\x20если\x20пользователь\x20выполнил\x20аутентификацию','../../src/model/auth','join','readFile','1465849NshOlh','user','Возвращает\x20редирект\x20на\x20/login\x20для\x20неаутентифицированных\x20пользователей','expect','Урок\x205.2','1625136VLwmmW','get','location','../../tpl/login.html','then','throw','608896jKuver','/login','/api/v1/profile','Возвращает\x20профиль\x20пользователя','catch','396071YZrfAo','Возвращает\x20ошибку\x20для\x20неаутентифицированных\x20пользователей','state','#GET\x20/','Возвращает\x20содержимое\x20index.html\x20для\x20аутентифицированных\x20пользователей','assertAuthenticated','4710xMitKr','1916sToRst','9YyIpAE','#GET\x20/api/v1/profile','callback','text','../../src/model/errors','#GET\x20/login','6lowdGK','promises'];a8_0x15f9=function(){return _0x23c367;};return a8_0x15f9();}function a8_0xcd07(_0x3ef074,_0x40e945){const _0x15f9f0=a8_0x15f9();return a8_0xcd07=function(_0xcd0788,_0x19263f){_0xcd0788=_0xcd0788-0x18f;let _0x496f8a=_0x15f9f0[_0xcd0788];return _0x496f8a;},a8_0xcd07(_0x3ef074,_0x40e945);}describe(a8_0x10fc95(0x1ab),()=>{const _0x2692d6=a8_0x10fc95;describe('#assertAuthenticated',()=>{const _0x378c56=a8_0xcd07;it(_0x378c56(0x199),async()=>{const _0x373915=_0x378c56,_0x47e781={'state':{}};expect(()=>assertAuthenticated(_0x47e781))['to'][_0x373915(0x1b1)](AuthenticationError);}),it(_0x378c56(0x1a3),async()=>{const _0x38c3bc={'state':{'user':{'email':uuid()}}};assertAuthenticated(_0x38c3bc);});}),describe(_0x2692d6(0x1ba),()=>{const _0x46799c=_0x2692d6,_0x2204db={'email':uuid()};beforeEach(()=>{const _0x19b2fb=a8_0xcd07;sinon[_0x19b2fb(0x1a0)](console,'error');}),it(_0x46799c(0x1a9),_0x54900c=>{const _0x40fd8d=_0x46799c;request(app[_0x40fd8d(0x192)]())[_0x40fd8d(0x1ad)]('/')[_0x40fd8d(0x1aa)](0x12e)[_0x40fd8d(0x1aa)](_0x40fd8d(0x1ae),'/login')[_0x40fd8d(0x1b0)](_0xca1869=>_0x54900c())[_0x40fd8d(0x1b6)](_0x54900c);}),it(_0x46799c(0x1bb),async()=>{const _0x1a4515=_0x46799c,_0x1176d1=await fs[_0x1a4515(0x1a6)](path[_0x1a4515(0x1a5)](__dirname,'../../tpl/index.html'));return sinon[_0x1a4515(0x1a0)](auth,_0x1a4515(0x1bc))['callsFake'](_0x341e53=>{const _0x53e2c0=_0x1a4515;_0x341e53[_0x53e2c0(0x1b9)][_0x53e2c0(0x1a8)]=_0x2204db;}),new Promise((_0x3514ea,_0x7d1f17)=>{const _0x568e87=_0x1a4515;request(app['callback']())[_0x568e87(0x1ad)]('/')[_0x568e87(0x1aa)](0xc8)[_0x568e87(0x1b0)](_0x224d75=>{const _0xf1203d=_0x568e87;expect(_0x224d75[_0xf1203d(0x193)])['to'][_0xf1203d(0x19f)](_0x1176d1['toString']()),_0x3514ea();})[_0x568e87(0x1b6)](_0x7d1f17);});});}),describe(_0x2692d6(0x195),()=>{it('Возвращает\x20содержимое\x20login.html',async()=>{const _0x13772a=a8_0xcd07,_0x27e1bc=await fs[_0x13772a(0x1a6)](path['join'](__dirname,_0x13772a(0x1af)));return new Promise((_0x112a20,_0x8f4f13)=>{const _0x42257d=_0x13772a;request(app[_0x42257d(0x192)]())[_0x42257d(0x1ad)](_0x42257d(0x1b3))[_0x42257d(0x1aa)](0xc8)[_0x42257d(0x1b0)](_0x5985af=>{const _0x48755a=_0x42257d;expect(_0x5985af[_0x48755a(0x193)])['to']['equal'](_0x27e1bc[_0x48755a(0x1a1)]()),_0x112a20();})['catch'](_0x8f4f13);});});}),describe(_0x2692d6(0x191),()=>{const _0x51aec6=_0x2692d6,_0xd20af6={'email':uuid()};beforeEach(()=>{const _0xcaec06=a8_0xcd07;sinon[_0xcaec06(0x1a0)](console,'error');}),it(_0x51aec6(0x1b8),_0x4d4f12=>{const _0x135907=_0x51aec6;request(app[_0x135907(0x192)]())[_0x135907(0x1ad)](_0x135907(0x1b4))[_0x135907(0x1aa)](0x191)[_0x135907(0x1b0)](_0x8c6747=>_0x4d4f12())['catch'](_0x4d4f12);}),it(_0x51aec6(0x1b5),async()=>{const _0xbadd5f=_0x51aec6;return sinon[_0xbadd5f(0x1a0)](auth,'assertAuthenticated')[_0xbadd5f(0x19a)](_0x10eb47=>{const _0xef18b9=_0xbadd5f;_0x10eb47[_0xef18b9(0x1b9)][_0xef18b9(0x1a8)]=_0xd20af6;}),new Promise((_0x5df6ac,_0x233a05)=>{const _0x3108fc=_0xbadd5f;request(app[_0x3108fc(0x192)]())[_0x3108fc(0x1ad)]('/api/v1/profile')[_0x3108fc(0x1aa)](0xc8)['then'](_0x3034c2=>{expect(_0x3034c2['body'])['to']['deep']['equal'](_0xd20af6),_0x5df6ac();})[_0x3108fc(0x1b6)](_0x233a05);});});});});